!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class e{constructor(){this.dbName="SetlistSprintDB",this.version=1,this.db=null,this.initDB()}initDB(){return new Promise((e,t)=>{const n=indexedDB.open(this.dbName,this.version);n.onerror=()=>t(n.error),n.onsuccess=()=>{this.db=n.result,e(this.db)},n.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains("songs")){const e=t.createObjectStore("songs",{keyPath:"id"});e.createIndex("name","name",{unique:!1}),e.createIndex("uploadedAt","uploadedAt",{unique:!1})}}})}async saveSong(e){return new Promise((t,n)=>{const s=this.db.transaction(["songs"],"readwrite").objectStore("songs").put(e);s.onerror=()=>n(s.error),s.onsuccess=()=>t(s.result)})}async loadSong(e){return new Promise((t,n)=>{const s=this.db.transaction(["songs"],"readonly").objectStore("songs").get(e);s.onerror=()=>n(s.error),s.onsuccess=()=>t(s.result)})}async deleteSong(e){return new Promise((t,n)=>{const s=this.db.transaction(["songs"],"readwrite").objectStore("songs").delete(e);s.onerror=()=>n(s.error),s.onsuccess=()=>t()})}async getAllSongs(){return new Promise((e,t)=>{const n=this.db.transaction(["songs"],"readonly").objectStore("songs").getAll();n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result)})}saveSongs(e){try{localStorage.setItem("songs_metadata",JSON.stringify(e))}catch(t){console.warn("localStorage quota exceeded",t)}}loadSongs(){try{const e=localStorage.getItem("songs_metadata");return e?JSON.parse(e):[]}catch(e){return[]}}}class t{constructor(e,t){this.storage=e,this.onSongUploaded=t}render(e){e.innerHTML='\n      <div class="flex flex-col items-center justify-center h-full p-6 bg-darker">\n        <div class="w-full max-w-md text-center">\n          \x3c!-- Upload Area --\x3e\n          <div id="drop-zone" class="border-2 border-dashed border-accent rounded-lg p-8 mb-6 cursor-pointer hover:bg-dark transition">\n            <div class="text-accent mb-4">\n              <svg class="w-16 h-16 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>\n              </svg>\n            </div>\n            <p class="text-white font-semibold mb-2">Drop audio file here</p>\n            <p class="text-gray-400 text-sm mb-4">or click to browse</p>\n            <p class="text-gray-500 text-xs">MP3, WAV, M4A, OGG ‚Ä¢ Max 50MB</p>\n            <input type="file" id="file-input" class="hidden" accept="audio/*">\n          </div>\n\n          \x3c!-- File Info (shown after upload) --\x3e\n          <div id="file-info" class="hidden bg-dark p-4 rounded-lg mb-6 text-left">\n            <div id="file-name" class="text-accent font-semibold mb-2"></div>\n            <div id="file-size" class="text-gray-400 text-sm mb-4"></div>\n            <button id="confirm-btn" class="w-full bg-accent text-dark font-semibold py-2 rounded-lg hover:bg-blue-400 transition">\n              Add to Setlist\n            </button>\n            <button id="cancel-btn" class="w-full mt-2 bg-gray-700 text-white py-2 rounded-lg hover:bg-gray-600 transition">\n              Choose Different File\n            </button>\n          </div>\n\n          \x3c!-- Recent Uploads --\x3e\n          <div id="recent-uploads" class="hidden">\n            <h3 class="text-gray-400 font-semibold mb-3">Uploaded Songs</h3>\n            <div id="songs-list" class="space-y-2"></div>\n          </div>\n        </div>\n      </div>\n    ';const t=e.querySelector("#drop-zone"),n=e.querySelector("#file-input"),s=e.querySelector("#file-info"),o=e.querySelector("#confirm-btn"),r=e.querySelector("#cancel-btn");let a=null;t.addEventListener("click",()=>n.click()),t.addEventListener("dragover",e=>{e.preventDefault(),t.classList.add("bg-dark")}),t.addEventListener("dragleave",()=>{t.classList.remove("bg-dark")}),t.addEventListener("drop",e=>{e.preventDefault(),t.classList.remove("bg-dark");const n=e.dataTransfer.files;n.length&&this.handleFileSelect(n[0])}),n.addEventListener("change",e=>{e.target.files.length&&this.handleFileSelect(e.target.files[0])});this.handleFileSelect=n=>{a=n;n.type.startsWith("audio/")?n.size>52428800?alert("File too large. Max 50MB."):(t.classList.add("hidden"),s.classList.remove("hidden"),e.querySelector("#file-name").textContent=`üìÑ ${n.name}`,e.querySelector("#file-size").textContent=`${(n.size/1024/1024).toFixed(2)} MB`):alert("Please select an audio file")},o.addEventListener("click",async()=>{if(a){const e=new FileReader;e.onload=async e=>{const o={id:Date.now(),name:a.name,duration:0,audioData:e.target.result,uploadedAt:(new Date).toISOString(),markers:{introStart:0,introEnd:0,outroStart:0,outroEnd:0}};await this.storage.saveSong(o),this.onSongUploaded(o),n.value="",a=null,t.classList.remove("hidden"),s.classList.add("hidden"),alert(`‚úÖ "${o.name}" added to Setlist`)},e.readAsArrayBuffer(a)}}),r.addEventListener("click",()=>{n.value="",a=null,t.classList.remove("hidden"),s.classList.add("hidden")})}}(new class{constructor(){this.storage=new e,this.currentSong=null,this.songs=[],this.init()}init(){this.render(),this.loadSongs(),this.showWarning()}render(){document.getElementById("app").innerHTML='\n      <div class="flex flex-col h-full bg-darker">\n        \x3c!-- Header --\x3e\n        <div class="bg-dark px-4 py-3 border-b border-gray-700">\n          <h1 class="text-2xl font-bold text-accent">Setlist Sprint</h1>\n          <p class="text-xs text-gray-400 mt-1">‚ö†Ô∏è Files clear when browser cache clears</p>\n        </div>\n\n        \x3c!-- Main Content --\x3e\n        <div class="flex-1 overflow-auto">\n          <div id="upload-container"></div>\n          <div id="player-container" class="hidden"></div>\n          <div id="setlist-container" class="hidden"></div>\n        </div>\n\n        \x3c!-- Tabs --\x3e\n        <div class="border-t border-gray-700 flex bg-dark">\n          <button id="tab-upload" class="flex-1 py-3 text-center text-accent border-b-2 border-accent">Upload</button>\n          <button id="tab-player" class="flex-1 py-3 text-center text-gray-500">Player</button>\n          <button id="tab-setlist" class="flex-1 py-3 text-center text-gray-500">Setlist</button>\n        </div>\n      </div>\n    ',document.getElementById("tab-upload").addEventListener("click",()=>this.switchTab("upload")),document.getElementById("tab-player").addEventListener("click",()=>this.switchTab("player")),document.getElementById("tab-setlist").addEventListener("click",()=>this.switchTab("setlist")),this.switchTab("upload")}switchTab(e){if(document.getElementById("upload-container").classList.toggle("hidden","upload"!==e),document.getElementById("player-container").classList.toggle("hidden","player"!==e),document.getElementById("setlist-container").classList.toggle("hidden","setlist"!==e),document.querySelectorAll('[id^="tab-"]').forEach(e=>{e.classList.remove("text-accent","border-b-2","border-accent"),e.classList.add("text-gray-500")}),document.getElementById(`tab-${e}`).classList.add("text-accent","border-b-2","border-accent"),"upload"===e){new t(this.storage,e=>this.onSongUploaded(e)).render(document.getElementById("upload-container"))}}onSongUploaded(e){this.songs.push(e),this.storage.saveSongs(this.songs),console.log("Song uploaded:",e.name)}loadSongs(){this.songs=this.storage.loadSongs(),console.log("Loaded songs:",this.songs)}showWarning(){sessionStorage.getItem("warned")||(alert("‚ö†Ô∏è WARNING: Audio files stored in your browser will be deleted when you clear your cache. Make backups if needed."),sessionStorage.setItem("warned","true"))}}).init();
